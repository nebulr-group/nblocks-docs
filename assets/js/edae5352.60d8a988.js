"use strict";(self.webpackChunknblocks_docs=self.webpackChunknblocks_docs||[]).push([[6843],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),h=r,b=p["".concat(s,".").concat(h)]||p[h]||d[h]||o;return n?a.createElement(b,l(l({ref:t},u),{},{components:n})):a.createElement(b,l({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),r=n(6010);const o="tabItem_Ymn6";function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,l),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>T});var a=n(7462),r=n(7294),o=n(6010),l=n(2466),i=n(6550),s=n(1980),c=n(7392),u=n(12);function d(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function b(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=p(e),[l,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[s,c]=b({queryString:n,groupId:a}),[d,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),m=(()=>{const e=s??d;return h({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{m&&i(m)}),[m]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),c(e),f(e)}),[c,f,o]),tabValues:o}}var m=n(2389);const k="tabList__CuJ",y="tabItem_LNqP";function g(e){let{className:t,block:n,selectedValue:i,selectValue:s,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.o5)(),p=e=>{const t=e.currentTarget,n=u.indexOf(t),a=c[n].value;a!==i&&(d(t),s(a))},h=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},c.map((e=>{let{value:t,label:n,attributes:l}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>u.push(e),onKeyDown:h,onClick:p},l,{className:(0,o.Z)("tabs__item",y,l?.className,{"tabs__item--active":i===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=f(e);return r.createElement("div",{className:(0,o.Z)("tabs-container",k)},r.createElement(g,(0,a.Z)({},e,t)),r.createElement(v,(0,a.Z)({},e,t)))}function T(e){const t=(0,m.Z)();return r.createElement(w,(0,a.Z)({key:String(t)},e))}},5741:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var a=n(7462),r=(n(7294),n(3905)),o=n(4866),l=n(5162);const i={sidebar_position:5,sidebar_label:"Protect your backend",tags:["security","backend","guide"]},s="Protect your backend",c={unversionedId:"authentication-and-access/protect-backend",id:"authentication-and-access/protect-backend",title:"Protect your backend",description:"Securing your backend is even more important than securing your frontend since the backend usually holds sensitive and important information that we never want to return to a user that is either not logged in or not the rightful recipient of that information.",source:"@site/docs/03-authentication-and-access/protect-backend.mdx",sourceDirName:"03-authentication-and-access",slug:"/authentication-and-access/protect-backend",permalink:"/nblocks-docs/docs/authentication-and-access/protect-backend",draft:!1,tags:[{label:"security",permalink:"/nblocks-docs/docs/tags/security"},{label:"backend",permalink:"/nblocks-docs/docs/tags/backend"},{label:"guide",permalink:"/nblocks-docs/docs/tags/guide"}],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,sidebar_label:"Protect your backend",tags:["security","backend","guide"]},sidebar:"tutorialSidebar",previous:{title:"Protect your frontend",permalink:"/nblocks-docs/docs/authentication-and-access/protect-frontend"},next:{title:"Self serviced with cloud views",permalink:"/nblocks-docs/docs/user-management/self-serviced-cloud-views"}},u={},d=[{value:"Short info about the access token",id:"short-info-about-the-access-token",level:2},{value:"Step 1. Protect an endpoint with role based access control",id:"step-1-protect-an-endpoint-with-role-based-access-control",level:2},{value:"Step 2. Protect an endpoint with data filter",id:"step-2-protect-an-endpoint-with-data-filter",level:2},{value:"Next steps",id:"next-steps",level:2}],p={toc:d};function h(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"protect-your-backend"},"Protect your backend"),(0,r.kt)("p",null,"Securing your backend is even more important than securing your frontend since the backend usually holds sensitive and important information that we never want to return to a user that is either not logged in or not the rightful recipient of that information."),(0,r.kt)("p",null,"In this guide we'll be showing you how easy it is to secure your application backend with Nblocks. You will apply protection in two ways by using the tokens obtained from the logged in user.\nThese ways are:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Protect an endpoint with role based access control"),", so that only users with the right privilege can query it."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Protect an endpoint with data filter"),", so that we can filter and return the correct data to a certain user.")),(0,r.kt)("p",null,"After you're done with this guide you will have an application backend that is secure and ready for production."),(0,r.kt)("p",null,"The Nblocks team provides, maintains, and adds code examples for popular languages continuously.\nHowever, if you have a specific need not covered by this quickstart yet, you'll find documentation on how to use Nblocks with any language in our API reference ",(0,r.kt)("a",{parentName:"p",href:"https://nebulr-group.github.io/nblocks-api-docs"},"API reference"),"."),(0,r.kt)("admonition",{title:"Prerequisites",type:"info"},(0,r.kt)("ol",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ol"},"You have completed the ",(0,r.kt)("a",{parentName:"li",href:"/docs/authentication-and-access/quickstart-user-login"},"Quickstart User Login")," and have access to the tokens obtained from the logged in user."))),(0,r.kt)("h2",{id:"short-info-about-the-access-token"},"Short info about the access token"),(0,r.kt)("p",null,"When you completed the ",(0,r.kt)("a",{parentName:"p",href:"/docs/authentication-and-access/quickstart-user-login"},"Quickstart User Login")," you got hold of a couple of tokens.\nOne of them, the access token holds the users access information and this information can be used to protect your app.\nThe token is encoded in a format called ",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT")," for greater portability and security. If we decode the access token it looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    // highlight-start\n    "scope": "AUTHENTICATED USER_READ USER_WRITE TENANT_READ TENANT_WRITE",\n    "role": "OWNER",\n    "sub": "63d2b5c18892e10022e083a2"\n    "tid": "63d2b5c18892e10022e08399",\n    // highlight-end\n    "plan": "FREE",\n    "iat": 1685648418,\n    "exp": 1685652018,\n    "aud": [\n        "63d2ab029e23db0afb07a5a7",\n        "https://app-stage.nblocks.cloud"\n    ],\n    "iss": "https://auth-stage.nblocks.cloud",\n    "aid": "63d2ab029e23db0afb07a5a7",\n}\n\n')),(0,r.kt)("admonition",{title:"Decoding JWTs",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"JWTs is a well known concept in security. That means there are plenty of libraries for many software stacks to decode them into readable JSON. Here's a extensive ",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io/libraries"},"list")," of different libraries.\nWe'll be using one of these in our code examples.")),(0,r.kt)("p",null,"In the structure above we highlighted the parts that we'll be focusing on in this guide. "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"role")," property tells the role of the user."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"scope")," property tells what privileges the user obtained when logging in as a that role. This can be used for more fine grained protection and role based access control on individual features."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"sub")," property shows the id of the user."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"scope")," property shows the id of the tenant / workspace")),(0,r.kt)("h2",{id:"step-1-protect-an-endpoint-with-role-based-access-control"},"Step 1. Protect an endpoint with role based access control"),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"expressjs",label:"ExpressJS",default:!0,mdxType:"TabItem"},(0,r.kt)("details",null,(0,r.kt)("summary",null,"More examples"))),(0,r.kt)(l.Z,{value:"angular",label:"Angular",default:!0,mdxType:"TabItem"}),(0,r.kt)(l.Z,{value:"pseudo",label:"Can't find your stack?",default:!0,mdxType:"TabItem"})),(0,r.kt)("h2",{id:"step-2-protect-an-endpoint-with-data-filter"},"Step 2. Protect an endpoint with data filter"),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"expressjs",label:"ExpressJS",default:!0,mdxType:"TabItem"},(0,r.kt)("details",null,(0,r.kt)("summary",null,"More examples"))),(0,r.kt)(l.Z,{value:"angular",label:"Angular",default:!0,mdxType:"TabItem"}),(0,r.kt)(l.Z,{value:"pseudo",label:"Can't find your stack?",default:!0,mdxType:"TabItem"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"That's all!")," With this guide we've show the best practises how you can protect your frontend application using the tokens generated from Nblocks Login"),(0,r.kt)("h2",{id:"next-steps"},"Next steps"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Protect your frontend with user tokens."),(0,r.kt)("li",{parentName:"ul"},"Add Nblocks hosted user management to your app."),(0,r.kt)("li",{parentName:"ul"},"Add SSO alternatives to your login experience.")),(0,r.kt)("p",null,"If you haven't already, join our ",(0,r.kt)("a",{parentName:"p",href:"https://discord.gg/kjWYdZ6f6G"},"Discord")))}h.isMDXComponent=!0}}]);