"use strict";(self.webpackChunknblocks_docs=self.webpackChunknblocks_docs||[]).push([[158],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=p(a),m=r,h=c["".concat(l,".").concat(m)]||c[m]||u[m]||o;return a?n.createElement(h,s(s({ref:t},d),{},{components:a})):n.createElement(h,s({ref:t},d))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=c;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var p=2;p<o;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},6711:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const o={sidebar_position:5,sidebar_label:"Users & Tenants"},s="Users & Tenants",i={unversionedId:"concepts/tenants-users",id:"concepts/tenants-users",title:"Users & Tenants",description:"Every time we've started a new SaaS project before we've seen the following needs for security and user management:",source:"@site/docs/concepts/tenants-users.mdx",sourceDirName:"concepts",slug:"/concepts/tenants-users",permalink:"/nblocks-docs/docs/concepts/tenants-users",draft:!1,editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/concepts/tenants-users.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,sidebar_label:"Users & Tenants"},sidebar:"tutorialSidebar",previous:{title:"Securing your app",permalink:"/nblocks-docs/docs/concepts/security"},next:{title:"Pricing plan",permalink:"/nblocks-docs/docs/concepts/pricing-plan"}},l={},p=[{value:"Tenants",id:"tenants",level:2},{value:"Users",id:"users",level:2},{value:"Onboarding your users",id:"onboarding-your-users",level:2}],d={toc:p};function u(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"users--tenants"},"Users & Tenants"),(0,r.kt)("p",null,"Every time we've started a new SaaS project before we've seen the following needs for security and user management:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Our customers' data needs to be organized in workspaces."),(0,r.kt)("li",{parentName:"ul"},"Users should be able to invite other users to the same workspace."),(0,r.kt)("li",{parentName:"ul"},"Users need to be able to login and granted a predefined set of privileges."),(0,r.kt)("li",{parentName:"ul"},"Some users would like to get access to several workspaces but still use the same credentials and one login."),(0,r.kt)("li",{parentName:"ul"},"Same user might be granted different privileges for different workspaces."),(0,r.kt)("li",{parentName:"ul"},"The workspace data should be easily distinguished in the database so we can build filters and accomplish data separation.")),(0,r.kt)("p",null,"We then sat down with all the learnings and created something flexible for you to use with the requirement that your app should not need to manage this yourself.\nWe decided to name ",(0,r.kt)("em",{parentName:"p"},"workspaces")," as ",(0,r.kt)("strong",{parentName:"p"},"tenants")," from the well known data separation architecture ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Multitenancy"},"Multitenancy"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"This is a central concept of Nblocks and defines how you can expect the data to be organized.")),(0,r.kt)("h2",{id:"tenants"},"Tenants"),(0,r.kt)("p",null,"A tenant represents an ",(0,r.kt)("strong",{parentName:"p"},"isolated workspace")," of a customer and encapsulates all its users and other data for that workspace.\nThe tenant contains information about the current subscription plan which can be used to render a specific feature set and other fields like locale which can be used to render translation resources.\nOther data could be files in the file storage etc. Many calls that you make to Nblocks require you to provide an identification for the tenant context for this purpose."),(0,r.kt)("admonition",{title:"Need an example?",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Who's the customer and how's that linked to a tenant? Let's think of two case."),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Business to Business"),(0,r.kt)("br",{parentName:"p"}),"\n","A company signing up to your app will get access to a new tenant. This company is your customer now and currently holds access to one tenant and a plan which you provision and get paid for. The intial and only user of the tenant will eventually start inviting more users (collegues) depending on your app offer."),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Business to Consumer"),(0,r.kt)("br",{parentName:"p"}),"\n","A person signs up for access to your app and is given access to a tenant. The person is your customer now and this customer currently holds access to one tenant and a plan which you provision and get paid for. In B2C cases it's more common that there will be only one user of a tenant but this depends what your app offer. As described, nothing really change between the cases except for who's the customer.")),(0,r.kt)("p",null,"Tenants get created automatically in Nblocks if you've using our ",(0,r.kt)("a",{parentName:"p",href:"/docs/essentials/payment-ready"},"payment ready")," solution.\nThere's also the option for you to manage this yourself and programatically create new tenants. Be aware that Nblocks will not monitor payments and automatically provision access to your app for manual tenants."),(0,r.kt)("p",null,"Here's an example of data that is made available to your app via the Tenant object:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Variable"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"id"),(0,r.kt)("td",{parentName:"tr",align:null},"Unique ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"name"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the tenant. Not set from the beginning until the Tenant owner complets tenant onboarding.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"plan"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the subscription plan. Automatically set by the payment service if tenant used the checkout process")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"locale"),(0,r.kt)("td",{parentName:"tr",align:null},"The default locale / lang code for all users in this tenant (",(0,r.kt)("inlineCode",{parentName:"td"},"ISO_639-1")," format). This property will set the i18n for all platform emails and can be used to")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"logo"),(0,r.kt)("td",{parentName:"tr",align:null},"Url to a public accessible logo")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"metadata"),(0,r.kt)("td",{parentName:"tr",align:null},"Store app specific meta data for this tenant")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"createdAt"),(0,r.kt)("td",{parentName:"tr",align:null},"A public url to a terms of service. Used in email footers etc.")))),(0,r.kt)("p",null,"Removing a tenant will also remove all of its data. This comes in handy because in the age of privacy protection your tenants own their data."),(0,r.kt)("admonition",{title:"Need to separate and filter user data?",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"A common solution is to add the tenant id on each of your own database entry so that you can easily separate and filter data based on what tenant the current user belongs to.\nThis will enable you to accomplish data separation when serving multiple users.")),(0,r.kt)("h2",{id:"users"},"Users"),(0,r.kt)("p",null,"A user represents an individual and his/her access to specific tenants and therefore your application. The same user can be added to several tenants and still use the same credentials as before. After login, the user will be able to select what tenant to access."),(0,r.kt)("p",null,"The user object contains personal information as well as other valuable fields for your use.\nHere's an example of data that is made available to your app via the User object:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Variable"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"id"),(0,r.kt)("td",{parentName:"tr",align:null},"Unique ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"role"),(0,r.kt)("td",{parentName:"tr",align:null},"Role of the user. Grants a set of privileges. Privileges are configured on the ",(0,r.kt)("inlineCode",{parentName:"td"},"App")," model. See ",(0,r.kt)("a",{parentName:"td",href:"/docs/concepts/security"},"security"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"email"),(0,r.kt)("td",{parentName:"tr",align:null},"Email address")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"username"),(0,r.kt)("td",{parentName:"tr",align:null},"Username to login as, currently same as email address")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"fullName"),(0,r.kt)("td",{parentName:"tr",align:null},"Users full name (first name and last name concatenated)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"onboarded"),(0,r.kt)("td",{parentName:"tr",align:null},"If the user is onboarded or not (should be put through onboarding after first login)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"enabled"),(0,r.kt)("td",{parentName:"tr",align:null},"If the user should be allowed to login or not. Changeable via user management view")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"teams"),(0,r.kt)("td",{parentName:"tr",align:null},"Array of identifiers that can be used to group several users into teams or groups")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"tenant"),(0,r.kt)("td",{parentName:"tr",align:null},"A nested Tenant object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"createdAt"),(0,r.kt)("td",{parentName:"tr",align:null},"Date when the user was created")))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Read more about users and how to secure access to your application based on their privileges ",(0,r.kt)("a",{parentName:"p",href:"/docs/concepts/security"},"here"),".")),(0,r.kt)("h2",{id:"onboarding-your-users"},"Onboarding your users"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A new tenant always creates a user with the role ",(0,r.kt)("inlineCode",{parentName:"li"},"OWNER"),". This gives the user the grant to change name, locale and manage the subscription (if using payment service) for the tenant using the nblocks-plugins provided views."),(0,r.kt)("li",{parentName:"ol"},"The new tenant owner user will receive an email containing an onboarding link to your app."),(0,r.kt)("li",{parentName:"ol"},"The onboarding link will guide the user through an initial set password process or redirect straight to login if the user already existed in another tenant."),(0,r.kt)("li",{parentName:"ol"},"After login, if it's a new user we'll ask for it's personal information like name. This can be configured, if you want to take care of this yourself."),(0,r.kt)("li",{parentName:"ol"},"The tenant owner is then handed over to your app and redirected to a specific ",(0,r.kt)("inlineCode",{parentName:"li"},"/onboarding")," and you can intiate your own onboarding.")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"After login, each subsequent call the user makes to your api will contain resolved security data about a new tenant and its user. It's now up to you to render data and a response to these requests.")))}u.isMDXComponent=!0}}]);