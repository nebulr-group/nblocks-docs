"use strict";(self.webpackChunknblocks_docs=self.webpackChunknblocks_docs||[]).push([[6796],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),h=r,k=p["".concat(s,".").concat(h)]||p[h]||d[h]||o;return n?a.createElement(k,l(l({ref:t},c),{},{components:n})):a.createElement(k,l({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var u=2;u<o;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},1263:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>C,contentTitle:()=>S,default:()=>j,frontMatter:()=>x,metadata:()=>I,toc:()=>_});var a=n(7462),r=n(7294),o=n(3905),l=n(6010),i=n(2466),s=n(6550),u=n(1980),c=n(7392),d=n(12);function p(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function k(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,u._X)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=h(e),[l,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!k({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[s,u]=g({queryString:n,groupId:a}),[c,p]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,d.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),m=(()=>{const e=s??c;return k({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{m&&i(m)}),[m]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!k({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),p(e)}),[u,p,o]),tabValues:o}}var b=n(2389);const f="tabList__CuJ",y="tabItem_LNqP";function v(e){let{className:t,block:n,selectedValue:o,selectValue:s,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.o5)(),p=e=>{const t=e.currentTarget,n=c.indexOf(t),a=u[n].value;a!==o&&(d(t),s(a))},h=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:i}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>c.push(e),onKeyDown:h,onClick:p},i,{className:(0,l.Z)("tabs__item",y,i?.className,{"tabs__item--active":o===t})}),n??t)})))}function w(e){let{lazy:t,children:n,selectedValue:a}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function N(e){const t=m(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",f)},r.createElement(v,(0,a.Z)({},e,t)),r.createElement(w,(0,a.Z)({},e,t)))}function T(e){const t=(0,b.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}const P="tabItem_Ymn6";function O(e){let{children:t,hidden:n,className:a}=e;return r.createElement("div",{role:"tabpanel",className:(0,l.Z)(P,a),hidden:n},t)}const x={sidebar_position:1,sidebar_label:"Quickstart User Login",tags:["guide","quickstart"]},S="Quickstart User Login",I={unversionedId:"user-login/quickstart-user-login",id:"user-login/quickstart-user-login",title:"Quickstart User Login",description:"On this page you will integrate your web application with Nblocks hosted login and have your users authenticate in no time. You can do this in your frontend or backend which can be in any stack or framework.",source:"@site/docs/02-user-login/quickstart-user-login.mdx",sourceDirName:"02-user-login",slug:"/user-login/quickstart-user-login",permalink:"/nblocks-docs/docs/user-login/quickstart-user-login",draft:!1,tags:[{label:"guide",permalink:"/nblocks-docs/docs/tags/guide"},{label:"quickstart",permalink:"/nblocks-docs/docs/tags/quickstart"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"Quickstart User Login",tags:["guide","quickstart"]},sidebar:"tutorialSidebar",previous:{title:"Switching to Nblocks",permalink:"/nblocks-docs/docs/getting-started/switching-to-nblocks"},next:{title:"Roles & Privileges",permalink:"/nblocks-docs/docs/access-and-security/roles-and-privileges"}},C={},_=[{value:"Step 1: Redirect users to Nblocks login",id:"step-1-redirect-users-to-nblocks-login",level:2},{value:"Add a redirect action",id:"add-a-redirect-action",level:3},{value:"Pseudocode",id:"pseudocode",level:4},{value:"Step 2: Recieve the user back to your app",id:"step-2-recieve-the-user-back-to-your-app",level:2},{value:"Add a callback route",id:"add-a-callback-route",level:3},{value:"Pseudocode",id:"pseudocode-1",level:4},{value:"Use the code to exchange for user tokens",id:"use-the-code-to-exchange-for-user-tokens",level:3},{value:"Step 4: Test it",id:"step-4-test-it",level:2},{value:"1. Start your app",id:"1-start-your-app",level:3},{value:"2. Navigate to /login",id:"2-navigate-to-login",level:3},{value:"3. Get redirected to Nblocks Login",id:"3-get-redirected-to-nblocks-login",level:3},{value:"4. Get redirected back to your app as a logged in user",id:"4-get-redirected-back-to-your-app-as-a-logged-in-user",level:3},{value:"Next steps",id:"next-steps",level:2}],E={toc:_};function j(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},E,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"quickstart-user-login"},"Quickstart User Login"),(0,o.kt)("p",null,"On this page you will integrate your web application with Nblocks hosted login and have your users authenticate in no time. You can do this in your frontend or backend which can be in any stack or framework.\nYou will apply a few lines of code to make redirects using the familiar OpenId Connect and OAuth 2.0 flows."),(0,o.kt)("p",null,"After you're done with this guide your application will have a login flow with sign in, sign up, and SSO. "),(0,o.kt)("admonition",{title:"Prerequisites",type:"info"},(0,o.kt)("ol",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ol"},"If you haven't already, ",(0,o.kt)("a",{parentName:"li",href:"/docs/getting-started/signup"},"sign up")," for Nblocks and get access to your ",(0,o.kt)("a",{parentName:"li",href:"/docs/getting-started/id-and-keys"},"app id")," "),(0,o.kt)("li",{parentName:"ol"},"An existing web application that can run on http://localhost:8080."))),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Not using http://localhost:8080?"),(0,o.kt)("p",null,"Nblocks is using sensible defaults to make development and integrations simpler.\nTo use another application address you need to change your app profile configuration."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Step 1. Open ",(0,o.kt)("inlineCode",{parentName:"strong"},"app-configuration.json"),"."),(0,o.kt)("br",{parentName:"p"}),"\n","This json file was downloaded when you signed up for Nblocks through terminal."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Step 2. Change the Oauth 2.0 callback uris."),(0,o.kt)("br",{parentName:"p"}),"\n","In the json file, change the defaultCallbackUri and redirectUris to the correct address for your application."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'"defaultCallbackUri": "http://localhost:3000/auth/oauth-callback",\n"redirectUris": [\n    "http://localhost:3000/auth/oauth-callback"\n],\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Step 3. Save the changes by pushing the updated configuration back to Nblocks")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-console"},"npx @nebulr-group/nblocks-cli push-app\n"))),(0,o.kt)("admonition",{title:"Code examples",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"You can view example projects using the code from this guide ",(0,o.kt)("a",{parentName:"p",href:"/docs/getting-started/example-projects"},"here"),".")),(0,o.kt)("h2",{id:"step-1-redirect-users-to-nblocks-login"},"Step 1: Redirect users to Nblocks login"),(0,o.kt)("h3",{id:"add-a-redirect-action"},"Add a redirect action"),(0,o.kt)("p",null,"Open your project source code in an editor of your choice.\nThen add an action in your app that will redirect the user to the Nblocks Login entrypoint at ",(0,o.kt)("inlineCode",{parentName:"p"},"https://auth-stage.nblocks.cloud/url/login/APP_ID")," where ",(0,o.kt)("inlineCode",{parentName:"p"},"APP_ID")," is your known app id.\nPreferrably you can add this action to the route ",(0,o.kt)("inlineCode",{parentName:"p"},"/login"),", so that when you access ",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:8080/login")," the redirect is triggered."),(0,o.kt)("p",null,"Below are pseudocode depending if you're implementing this for a frontend or backend."),(0,o.kt)("h4",{id:"pseudocode"},"Pseudocode"),(0,o.kt)(T,{mdxType:"Tabs"},(0,o.kt)(O,{value:"frontend",label:"Frontend",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'var APP_ID = "XXX";\n// Immediately redirect the web browser to Nblocks login\nwindow.location.href = `https://auth-stage.nblocks.cloud/url/login/${APP_ID}`;\n\n'))),(0,o.kt)(O,{value:"backend",label:"Backend",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'var APP_ID = "XXX";\n// Create an api endpoint "/login"\nrouter.get("/login", (req, res) => {\n    // Redirect the web browser to Nblocks login\n    res.redirect(`https://auth-stage.nblocks.cloud/url/login/${APP_ID}`)\n})\n')))),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Here we're using the ",(0,o.kt)("inlineCode",{parentName:"p"},"/authorize")," endpoint. For more details see the ",(0,o.kt)("a",{parentName:"p",href:"https://nebulr-group.github.io/nblocks-api-docs/#short-hand-authorize"},"API reference"))),(0,o.kt)("h2",{id:"step-2-recieve-the-user-back-to-your-app"},"Step 2: Recieve the user back to your app"),(0,o.kt)("p",null,"When the user completes authentication with Nblocks Login, the user is redirected back to your app with a code that we will resolve into something more useful.\nThe URL containing the code parameter will look like this: ",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:8080/auth/oauth-callback?code=XXXXXX....")),(0,o.kt)("h3",{id:"add-a-callback-route"},"Add a callback route"),(0,o.kt)("p",null,"Add a new route ",(0,o.kt)("inlineCode",{parentName:"p"},"/auth/oauth-callback")," in your app that will act as a handler when the user is returned. In this handler you should add source code that retrieves the code parameter from the URL mentioned above and save it."),(0,o.kt)("p",null,"Below are pseudocode depending if you're implementing this for a frontend or backend."),(0,o.kt)("h4",{id:"pseudocode-1"},"Pseudocode"),(0,o.kt)(T,{mdxType:"Tabs"},(0,o.kt)(O,{value:"frontend",label:"Frontend",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"// Grab the code parameter from current URL\nvar code = (new URL(window.location.href)).searchParams.get('code');\n"))),(0,o.kt)(O,{value:"backend",label:"Backend",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'// Create an api endpoint "/auth/oauth-callback"\nrouter.get("/auth/oauth-callback", (req, res) => {\n    // Grab the code query parameter from the request\n    var code = req.query.code;\n})\n')))),(0,o.kt)("h3",{id:"use-the-code-to-exchange-for-user-tokens"},"Use the code to exchange for user tokens"),(0,o.kt)("p",null,"With the code now successfully obtained we can exchange it for more useful user profile information.\nYour app should make an API call in order to make this exchange.\nThe returning response contains secure token data and a resolved user profile which you can print to the console or display on your frontend page."),(0,o.kt)(T,{mdxType:"Tabs"},(0,o.kt)(O,{value:"rest",label:"Rest",default:!0,mdxType:"TabItem"},(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Request")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"POST https://auth-stage.nblocks.cloud/token/code/APP_ID\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Response")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "token_type": "Bearer",\n  "expires_in": 3600,\n  "access_token": "eyJhbGciOiJQ...",\n  "refresh_token": "eyJhbGciOiJQ...",\n  "id_token": "eyJhbGciOiJQ...",\n  "user_profile": {\n    "name": "John Doe",\n    "family_name": "Doe",\n    "given_name": "John",\n    ...\n  }\n}\n'))),(0,o.kt)(O,{value:"js",label:"JS",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'const APP_ID = "XXXX";\nconst code = "XXXX"; // This is the code you just obtained\n\n// Make the API call to Nblocks\nconst result = await fetch(`https://auth-stage.nblocks.cloud/token/code/${APP_ID}`,\n  {\n    method: "POST",\n    headers: {\n      "Content-Type": "application/json",\n    },\n    body: JSON.stringify({\n      code: code,\n    }),\n  }\n).then(res => res.json());\n\n// Print the user info to console\nconsole.log(result.user_profile);\n')))),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Here we're using the ",(0,o.kt)("inlineCode",{parentName:"p"},"/token")," endpoint. For more details see the ",(0,o.kt)("a",{parentName:"p",href:"https://nebulr-group.github.io/nblocks-api-docs/#shorthand-get-tokens"},"API reference"))),(0,o.kt)("h2",{id:"step-4-test-it"},"Step 4: Test it"),(0,o.kt)("h3",{id:"1-start-your-app"},"1. Start your app"),(0,o.kt)("p",null,"Start your application so that it is accessible on ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:8080"},"http://localhost:8080")),(0,o.kt)("h3",{id:"2-navigate-to-login"},"2. Navigate to /login"),(0,o.kt)("p",null,"Navigate to ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:8080/login"},"http://localhost:8080/login")),(0,o.kt)("h3",{id:"3-get-redirected-to-nblocks-login"},"3. Get redirected to Nblocks Login"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nblocks Login",src:n(158).Z,width:"3456",height:"2161"}),"\nThis is Nblocks Login. Since you don't have a previous user account click \"",(0,o.kt)("strong",{parentName:"p"},"Create one"),'".\nYou can signup with your email or use Google or Microsoft SSO for a faster process.'),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nblocks Google SSO",src:n(7918).Z,width:"3456",height:"2159"})),(0,o.kt)("p",null,"Here we have clicked to signup with Google. The Google login screen is shown."),(0,o.kt)("h3",{id:"4-get-redirected-back-to-your-app-as-a-logged-in-user"},"4. Get redirected back to your app as a logged in user"),(0,o.kt)("p",null,"After logging in, you get redirected back to your application again.\n",(0,o.kt)("img",{alt:"Callback",src:n(1173).Z,width:"3456",height:"2159"}),"\nObserve that we now see the user information beeing printed out in the console."),(0,o.kt)("h2",{id:"next-steps"},"Next steps"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Add SSO alternatives to your login experience."),(0,o.kt)("li",{parentName:"ul"},"Understand the mechanics of user tokens and how you can trust them in your app."),(0,o.kt)("li",{parentName:"ul"},"Protect your frontend and backend with user tokens."),(0,o.kt)("li",{parentName:"ul"},"Add Nblocks hosted user management to your app."),(0,o.kt)("li",{parentName:"ul"},"Go through the checklist before going live.")))}j.isMDXComponent=!0},1173:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/callback-screen-0eae092ca09b00f8068406d9b690c276.png"},7918:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/google-screen-7122b101abf02b48b1eb49183af6ebe9.png"},158:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/login-screen-8e1ca7623214fa765ddf83956e1a5eb7.png"}}]);