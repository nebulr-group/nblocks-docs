---
sidebar_position: 1
sidebar_label: Quickstart User Login
tags:
    - guide
    - quickstart
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Quickstart User Login
On this page you will integrate an app in any stack with Nblocks hosted login and have your users authenticate in no time. You can do this in your frontend or backend. You will apply a few lines of code using redirects using the familiar Open Id Connect, and OAuth2 flows.

After you're done with this guide your application will have a login flow with sign in, sign up, and SSO. 

:::info Prerequisites

1. If you haven't already, [sign up](/docs/getting-started/signup) for Nblocks and get access to your [app id](/docs/getting-started/id-and-keys) 
1. You need a web project in any stack that can run on http://localhost:8080

:::

:::tip Code examples

You can view example projects using the code from this guide [here](/docs/getting-started/example-projects).

:::

## Step 1: Redirect the user to Nblocks login
We now want your app to navigate a user to Nblocks login. 

### Open your project code base
Open your project source code in an editor of your choice.

### Add a login route
Add a new route in your app and redirect your user to the Nblocks Login entrypoint.
Below are pseudo code depending if you're implementing this for a frontend or backend.

#### Pseudo code
<Tabs>
<TabItem value="frontend" label="Frontend" default>

```ts
var APP_ID = "XXX";
window.location.href = `https://auth-stage.nblocks.cloud/url/login/${APP_ID}`;

```

</TabItem>

<TabItem value="backend" label="Backend" default>

```ts
var APP_ID = "XXX";
router.get("/login", (req, res) => {
    res.redirect(`https://auth-stage.nblocks.cloud/url/login/${APP_ID}`)
})
```

</TabItem>
</Tabs>

:::tip

Here we're using the `/authorize` endpoint. For more details see the [API reference](https://nebulr-group.github.io/nblocks-api-docs/#short-hand-authorize)

:::

Now the user will be redirected from your app to Nblocksl Login.

## Step 3: Recieve the user back to your app
When the user completes authentication with Nblocks Login, the user is redirected back to your app with a code that we will resolve into something more useful.
The URL looks like this: 
`http://localhost:8080/auth/oauth-callback?code=eyJh....`

### Add a callback route
Add a new route in your app that acts as a handler when the user is returned. Your code must be able to retrieve the code parameter from the URL mentioned above. 

#### Pseudo code
<Tabs>
<TabItem value="frontend" label="Frontend" default>

```ts
var code = (new URL(window.location.href)).searchParams.get('code');
```

</TabItem>

<TabItem value="backend" label="Backend" default>

```ts
router.get("/auth/oauth-callback", (req, res) => {
    var code = req.query.code;
})
```

</TabItem>
</Tabs>

### Exchange the code for tokens
With the code now successfully obtained we can exchange it for more useful profile information. 
Your app should make an API call in order to make this exchange. 
The returning response contains secure token data and a resolved user profile which you can print to the console or display on your frontend page.

<Tabs>
<TabItem value="rest" label="Rest" default>

Request
```ts
POST https://auth-stage.nblocks.cloud/token/code/APP_ID
```

Response
```json
{
  "token_type": "Bearer",
  "expires_in": 3600,
  "access_token": "eyJhbGciOiJQ...",
  "refresh_token": "eyJhbGciOiJQ...",
  "id_token": "eyJhbGciOiJQ...",
  "user_profile": {
    "name": "John Doe",
    "family_name": "Doe",
    "given_name": "John",
    ...
  }
}
```

</TabItem>

<TabItem value="js" label="JS" default>

```ts
const APP_ID = "XXXX";
const code = "XXXX";
const result = await fetch(`https://auth-stage.nblocks.cloud/token/code/${APP_ID}`,
  {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      code: code,
    }),
  }
).then(res => res.json());

// Print the user info
console.log(result.user_profile);
```

</TabItem>

</Tabs>

:::tip

Here we're using the `/token` endpoint. For more details see the [API reference](https://nebulr-group.github.io/nblocks-api-docs/#shorthand-get-tokens)

:::

## Step 4: Test it
You should now be able to see Nblocks Login in action by testing it.

### 1. Start your app

### 2. Navigate to /login

### 3. Get redirected to Nblocks Login
Here we show how nice it looks. Youtube? Images? etc.

The user signs up or logs in.

### 4. Get back to your app as a logged in user

## Next steps

- Add SSO alternatives to your login experience.
- Understand the mechanics of user tokens and how you can trust them in your app.
- Protect your frontend and backend with user tokens.
- Add Nblocks hosted user management to your app.
- Go through the checklist before going live.
